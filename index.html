<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Ephemeral PGP Chat</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="client/css/style.css">
    <script type="module">
import openpgp from 'https://cdn.jsdelivr.net/npm/openpgp@6.3.0/+esm'
</script>
</head>
<body>
    <div id="setup-view">
        <h2>Enter Username</h2>
        <input type="text" id="username-input" placeholder="e.g. alice" maxlength="20">
        <button id="generate-btn">Generate Identity</button>
        <p id="setup-status"></p>
    </div>

    <div id="chat-view" style="display: none;">
    <div class="header-info">
		<h3 id="my-identity"></h3>
		<div class="meta-controls">
			<p id="ttl-timer">Expires: <span id="timer-val">--:--</span></p>
			<button id="burn-btn" class="danger-btn">ðŸ”¥ Burn Session</button>
		</div>
	</div>
    
    <div class="tabs">
		<button id="tab-inbox" class="active">
			Inbox <span id="inbox-badge" class="badge-main" style="display:none"></span>
		</button>
		<button id="tab-requests">
			Requests <span id="req-badge" class="badge" style="display:none">0</span>
		</button>
	</div>

    <div id="inbox-panel" class="tab-panel">
        <h4>Contacts</h4>
        <ul id="active-chats"></ul>
    </div>

    <div id="requests-panel" class="tab-panel" style="display: none;">
    <h4>Incoming Requests</h4>
    <ul id="incoming-requests"></ul>
</div>

<div id="chat-panel" class="tab-panel" style="display: none;">
    <div id="handshake-init-view">
        <h4>Start New Secure Session</h4>
        <input type="text" id="target-id" placeholder="username#1234">
        <button id="send-req-btn">Send Invitation</button>
    </div>

    <div id="active-chat-view" style="display: none;">
        <h4 id="chatting-with"></h4>
        <div id="messages"></div>
        <div class="input-area">
            <input type="text" id="msg-input" placeholder="Type a message...">
            <button id="send-msg-btn">Send</button>
        </div>
    </div>
</div>

<button id="tab-chat" class="fab-chat" title="Start New Handshake" aria-label="Start New Handshake">ðŸ’¬<span class="fab-plus">+</span></button>
</div>

    <script type="module" src="client/js/app.js"></script>
</body>
</html>
